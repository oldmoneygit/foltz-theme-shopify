{%- comment -%}
  HEADER SECTION
  Replicates: src/components/Header.jsx from Next.js project
{%- endcomment -%}

<!-- Promotional Banner -->
<div class="promotional-banner">
  {{ section.settings.promotional_text }}
</div>

<!-- Main Header -->
<header class="header" id="header">
  <div class="container">
    <!-- Top Bar: Logo, Search, Icons -->
    <div class="header-top">
      <!-- Mobile Menu Toggle (visible only on mobile) -->
      <button class="mobile-menu-toggle lg:hidden" id="mobile-menu-toggle" aria-label="Toggle Menu">
        {% render 'icon-menu', size: 24 %}
      </button>

      <!-- Logo -->
      <a href="/" class="header-logo">
        {%- if section.settings.logo -%}
          <img src="{{ section.settings.logo | img_url: '320x96' }}" alt="{{ shop.name }}" loading="eager">
        {%- else -%}
          <img src="{{ 'logo-white.png' | asset_url }}" alt="{{ shop.name }}" loading="eager">
        {%- endif -%}
      </a>

      <!-- Search Bar (desktop only) -->
      <div class="header-search">
        <form action="/search" method="get">
          <input
            type="text"
            name="q"
            placeholder="{{ 'general.search.placeholder' | t }}"
            autocomplete="off"
            id="header-search-input"
          >
          <button type="submit" aria-label="{{ 'general.search.submit' | t }}">
            {% render 'icon-search', size: 20 %}
          </button>
        </form>
      </div>

      <!-- Actions: Wishlist & Cart -->
      <div class="header-actions">
        <!-- Wishlist Icon -->
        <a href="/pages/favoritos" class="header-icon" aria-label="Favoritos">
          {% render 'icon-heart', size: 24 %}
          <span class="header-icon-badge" style="display: none;">0</span>
        </a>

        <!-- Cart Icon -->
        <a href="/cart" class="header-icon" aria-label="Shopping Cart">
          {% render 'icon-cart', size: 24 %}
          {%- if cart.item_count > 0 -%}
            <span class="header-icon-badge">{{ cart.item_count }}</span>
          {%- endif -%}
        </a>
      </div>
    </div>

    <!-- Navigation Menu (desktop only) -->
    <nav class="header-nav">
      <ul>
        {%- for link in section.settings.menu.links -%}
          {%- if link.links != blank -%}
            <!-- Menu item with submenu -->
            <li class="header-nav-item-dropdown">
              <button class="header-nav-dropdown-toggle">
                {{ link.title }}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
              <div class="header-nav-dropdown">
                {%- for child_link in link.links -%}
                  <a href="{{ child_link.url }}">{{ child_link.title }}</a>
                {%- endfor -%}
              </div>
            </li>
          {%- else -%}
            <!-- Regular menu item -->
            <li>
              <a href="{{ link.url }}">{{ link.title }}</a>
            </li>
          {%- endif -%}
        {%- endfor -%}
      </ul>
    </nav>
  </div>
</header>

<!-- Mobile Menu Backdrop -->
<div class="mobile-menu-backdrop" id="mobile-menu-backdrop"></div>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobile-menu">
  <div class="mobile-menu-header">
    <span class="mobile-menu-title">Menu</span>
    <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Close Menu">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <div class="mobile-menu-content">
    <!-- Mobile Menu Items -->
    <ul class="mobile-menu-list">
      {%- for link in section.settings.menu.links -%}
        {%- if link.links != blank -%}
          <!-- Menu item with submenu -->
          <li class="mobile-menu-item-dropdown">
            <button class="mobile-menu-dropdown-toggle">
              {{ link.title }}
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </button>
            <ul class="mobile-menu-submenu">
              {%- for child_link in link.links -%}
                <li>
                  <a href="{{ child_link.url }}">{{ child_link.title }}</a>
                </li>
              {%- endfor -%}
            </ul>
          </li>
        {%- else -%}
          <!-- Regular menu item -->
          <li>
            <a href="{{ link.url }}">{{ link.title }}</a>
          </li>
        {%- endif -%}
      {%- endfor -%}
    </ul>

    <!-- Mobile Search -->
    <div class="mobile-menu-search">
      <form action="/search" method="get">
        <input
          type="text"
          name="q"
          placeholder="{{ 'general.search.placeholder' | t }}"
          autocomplete="off"
        >
        <button type="submit" aria-label="{{ 'general.search.submit' | t }}">
          {% render 'icon-search', size: 20 %}
        </button>
      </form>
    </div>
  </div>
</div>

<style>
/* Mobile Menu Specific Styles */
.mobile-menu-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-4);
  border-bottom: 1px solid var(--color-yellow-20);
}

.mobile-menu-title {
  color: var(--color-brand-yellow);
  font-weight: var(--font-weight-black);
  font-size: var(--font-size-lg);
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wider);
}

.mobile-menu-close {
  padding: var(--spacing-2);
  color: var(--color-brand-white);
  transition: color var(--transition-base);
}

.mobile-menu-close:hover {
  color: var(--color-brand-yellow);
}

.mobile-menu-content {
  display: flex;
  flex-direction: column;
  height: calc(100% - 72px);
}

.mobile-menu-list {
  flex: 1;
  padding: var(--spacing-6) var(--spacing-4);
  overflow-y: auto;
}

.mobile-menu-list > li {
  margin-bottom: var(--spacing-2);
}

.mobile-menu-list > li > a {
  display: flex;
  align-items: center;
  padding: var(--spacing-3) var(--spacing-4);
  color: var(--color-brand-white);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-bold);
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wide);
  transition: all var(--transition-base);
  border-radius: var(--radius-lg);
}

.mobile-menu-list > li > a:hover {
  color: var(--color-brand-yellow);
  background: var(--color-yellow-5);
}

.mobile-menu-dropdown-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: var(--spacing-3) var(--spacing-4);
  color: var(--color-brand-white);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-bold);
  text-transform: uppercase;
  letter-spacing: var(--letter-spacing-wide);
  transition: all var(--transition-base);
  border-radius: var(--radius-lg);
}

.mobile-menu-dropdown-toggle:hover {
  color: var(--color-brand-yellow);
  background: var(--color-yellow-5);
}

.mobile-menu-dropdown-toggle svg {
  transition: transform var(--transition-base);
}

.mobile-menu-dropdown-toggle.active svg {
  transform: rotate(180deg);
}

.mobile-menu-submenu {
  display: none;
  margin-left: var(--spacing-4);
  margin-top: var(--spacing-2);
}

.mobile-menu-submenu.active {
  display: block;
}

.mobile-menu-submenu li {
  margin-bottom: var(--spacing-1);
}

.mobile-menu-submenu a {
  display: block;
  padding: var(--spacing-2) var(--spacing-4);
  color: var(--color-white-80);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  transition: all var(--transition-base);
  border-radius: var(--radius-lg);
}

.mobile-menu-submenu a:hover {
  color: var(--color-brand-yellow);
  background: var(--color-yellow-5);
}

.mobile-menu-search {
  padding: var(--spacing-4);
  border-top: 1px solid var(--color-white-20);
}

.mobile-menu-search form {
  position: relative;
}

.mobile-menu-search input {
  width: 100%;
  padding: var(--spacing-3) var(--spacing-4);
  padding-right: 48px;
  background: var(--color-white-10);
  border: 2px solid var(--color-white-20);
  border-radius: var(--radius-lg);
  color: var(--color-brand-white);
  font-size: var(--font-size-sm);
}

.mobile-menu-search input::placeholder {
  color: var(--color-white-40);
}

.mobile-menu-search input:focus {
  border-color: var(--color-brand-yellow);
  outline: none;
}

.mobile-menu-search button {
  position: absolute;
  right: 0;
  top: 0;
  height: 100%;
  padding: 0 var(--spacing-4);
  background: var(--color-brand-yellow);
  color: var(--color-brand-black);
  border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
}

/* Desktop Dropdown Navigation */
.header-nav-item-dropdown {
  position: relative;
}

.header-nav-dropdown-toggle {
  display: flex;
  align-items: center;
  gap: var(--spacing-2);
}

.header-nav-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: var(--spacing-2);
  width: 224px;
  background: #171717;
  border: 2px solid var(--color-yellow-20);
  border-radius: var(--radius-lg);
  padding: var(--spacing-2);
  box-shadow: 0 10px 40px rgba(218, 241, 13, 0.1);
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all var(--transition-base);
  z-index: var(--z-dropdown);
}

.header-nav-item-dropdown:hover .header-nav-dropdown {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.header-nav-dropdown a {
  display: block;
  padding: var(--spacing-3) var(--spacing-4);
  color: var(--color-brand-white);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  border-radius: var(--radius-md);
  transition: all var(--transition-base);
}

.header-nav-dropdown a:hover {
  background: var(--color-yellow-10);
  color: var(--color-brand-yellow);
}
</style>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "promotional_text",
      "label": "Promotional Banner Text",
      "default": "ENVÍO GRATIS A TODA ARGENTINA"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Main Menu",
      "default": "main-menu"
    }
  ]
}
{% endschema %}
